function LoadScreen(a,b){"use strict";function c(a,b){r||(m.domElement.style.marginTop="-"+b+"px",m.domElement.style.height=b+"px",m.domElement.style.width=a+"px")}function d(){var a=m.resources;if(a.textures){z+=Object.keys(a.textures).length,output.textures={};for(var b in a.textures)output.textures[b]={},D[b]={prog:0,size:a.textures[b].size},F+=a.textures[b].size}if(a.geometries){z+=Object.keys(a.geometries).length,output.geometries={};for(var b in a.geometries)output.geometries[b]={},E[b]={prog:0,size:a.geometries[b].size},G+=a.geometries[b].size}if(a.geometries)for(var b in a.geometries)e(b);if(a.textures)for(var b in a.textures)f(b)}function e(a){var b=m.resources.geometries[a];b.path.indexOf(".json")>-1&&(A.json||(A.json=new THREE.JSONLoader),A.json.load(b.path,function(b){b.name=a,output.geometries[a]=b,E[a].prog=1,x++,l({geometry:!0,name:a,progress:1})},function(b){var c=b.loaded/b.total;E[a].prog=c,1!==c&&l({geometry:!0,name:a,progress:c})}))}function f(a){var b=m.resources.textures[a];B||(B=new THREE.TextureLoader),B.load(b.path,function(c){for(var d in b)"size"!==d&&"path"!==d&&"undefined"!=typeof c[d]&&(c[d]=b[d]);c.name=a,output.textures[a]=c,D[a].prog=1,x++,l({texture:!0,name:a,progress:1})},function(b){var c=b.loaded/b.total;D[a].prog=c,1!==c&&l({texture:!0,name:a,progress:c})})}function g(){var c=document.createElement("div"),d=document.createElement("div");c.style.cssText="background: "+b.background+";position: relative;overflow: hidden;",d.style.cssText="width: "+b.size+"; height: "+b.size+";top: 50%; left: 50%;margin: -50px 0 0 -50px;position: relative;",m.domElement=c,m.infoContainer=d,m.resize(a.domElement.width,a.domElement.height),a.domElement.parentNode.appendChild(c),c.appendChild(d)}function h(){switch(b.type){case"bar":i();break;case"circle":k();break;default:i()}}function i(){var a=document.createElement("div"),c=document.createElement("div");a.style.cssText="background: "+b.progressBarContainer+";border: solid 1px "+b.progressBarContainer+";width: "+b.size+"; height: 6px;top: 50%; left: 50%;box-sizing: border-box;margin-left: -50px;position: relative;",c.style.cssText="background: "+b.progressBar+";width: 0%; height: 100%;top: 0; left: 0;position: absolute;",a.appendChild(c),m.infoContainer.appendChild(a);var d=function(){c.style.width=(100*t.progress).toString()+"%"};u.push(function(){TweenLite.to(t,s,{progress:q,onUpdate:d})}),w=function(){TweenLite.to(t,s,{progress:q,onUpdate:d,onComplete:j})}}function j(){processFiles();for(var a=0;a<v.length;a++)v[a]()}function k(){}function l(a){var b=0,c=0;for(var d in D)b+=D[d].prog*D[d].size;for(var d in E)c+=E[d].prog*E[d].size;if(q=(b+c)/(F+G),"undefined"!=typeof a&&o){var e=a.texture?"Texture":a.geometry?"Geometry":"Unknown asset type";console.info(e+" > "+a.name+" > "+Math.round(100*a.progress)+"%")}for(var f=0;f<u.length;f++)u[f](q);x===z&&(q=1,w())}var m=this,n=null,o=!1,p=!1,q=0,r=!1,s=1,t={progress:0},u=[],v=[],w,x=0,y=0,z=0,A={},B,C={},D={},E={},F=0,G=0;return this.domElement=null,this.infoContainer=null,this.resources=null,this.resize=c,b=b||{},b={type:"undefined"!=typeof b.type?b.type:"bar",size:b.size?b.size:"100px",background:b.background?b.background:"#ddd",progressBarContainer:b.progressBarContainer?b.progressBarContainer:"#bbb",progressBar:b.progressBar?b.progressBar:"#666",percentInfo:"undefined"!=typeof b.percentInfo&&b.percentInfo,sizeInfo:"undefined"!=typeof b.sizeInfo&&b.sizeInfo,textInfo:"undefined"!=typeof b.textInfo?b.textInfo:["Loading","Creating scene"]},g(),h(),this.start=function(a){b!==!1&&m.domElement.appendChild(m.infoContainer),a&&(m.resources=a,d())},this.remove=function(){m.domElement.parentNode.removeChild(m.domElement),r=!0},this.setProgress=function(a){q=a,b!==!1&&l()},this.setOptions=function(a){return s="undefined"!=typeof a.tweenDuration?a.tweenDuration:s,p="undefined"!=typeof a.forcedStart?a.forcedStart:p,o="undefined"!=typeof a.verbose?a.verbose:o,m},this.onProgress=function(){for(var a=0;a<arguments.length;a++)arguments[a]&&"function"==typeof arguments[a]&&u.push(arguments[a]);return m},this.onComplete=function(){for(var a=0;a<arguments.length;a++)arguments[a]&&"function"==typeof arguments[a]&&v.push(arguments[a]);return m},this}