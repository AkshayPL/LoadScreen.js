function LoadScreen(a,b){"use strict";function c(a,b){t||(o.domElement.style.marginTop="-"+b+"px",o.domElement.style.height=b+"px",o.domElement.style.width=a+"px")}function d(){var a=o.resources;if(a.textures){B+=Object.keys(a.textures).length,output.textures={};for(var b in a.textures)output.textures[b]={},F[b]={prog:0,fileSize:a.textures[b].fileSize},H+=a.textures[b].fileSize}if(a.geometries){B+=Object.keys(a.geometries).length,output.geometries={};for(var b in a.geometries)output.geometries[b]={},G[b]={prog:0,fileSize:a.geometries[b].fileSize},I+=a.geometries[b].fileSize}if(a.geometries)for(var b in a.geometries)e(b);if(a.textures)for(var b in a.textures)f(b)}function e(a){var b=o.resources.geometries[a];b.path.indexOf(".json")>-1&&(C.json||(C.json=new THREE.JSONLoader),C.json.load(b.path,function(b){b.name=a,output.geometries[a]=b,G[a].prog=1,z++,l({geometry:!0,name:a,progress:1}),m(!0)},function(b){var c=b.loaded/b.total;G[a].prog=c,1!==c&&l({geometry:!0,name:a,progress:c}),m()}))}function f(a){var b=o.resources.textures[a];D||(D=new THREE.TextureLoader),D.load(b.path,function(c){for(var d in b)"fileSize"!==d&&"path"!==d&&"undefined"!=typeof c[d]&&(c[d]=b[d]);c.name=a,output.textures[a]=c,F[a].prog=1,z++,l({texture:!0,name:a,progress:1}),m(!0)},function(b){var c=b.loaded/b.total;F[a].prog=c,1!==c&&l({texture:!0,name:a,progress:c}),m()})}function g(){var a=o.resources.textures,b=output.textures;if(a)for(var c in b){for(var d in a[c])"path"!==d&&"fileSize"!==d&&(b[c][d]=a[c][d]);a[c]=b[c],delete b[c]}var e=o.resources.geometries,f=output.geometries;if(e)for(var c in f)e[c].toBufferGeometry&&"BufferGeometry"!==f[c].type&&(f[c]=(new THREE.BufferGeometry).fromGeometry(f[c])),e[c].copyUv1ToUv2&&"BufferGeometry"===f[c].type&&f[c].addAttribute("uv2",f[c].attributes.uv),e[c].computeNormals&&f[c].computeVertexNormals(),e[c].computeFlatNormals&&f[c].computeFlatVertexNormals(),e[c]=f[c],delete f[c];var g=o.resources.objects;if(g)for(var c in g){var h=o.resources.geometries[g[c].geometry],i=g[c].material;delete g[c].geometry,delete g[c].material;for(var d in g[c])"type"!==d&&"undefined"!=typeof i[d]&&(d.indexOf("map")>-1||d.indexOf("Map")>-1?i[d]=a[g[c][d]]:i[d]=g[c][d],delete g[c][d]);var j;switch(g[c].type){case"mesh":j=new THREE.Mesh(h,i);break;case"points":j=new THREE.Points(h,i);break;case"line":j=new THREE.Line(h,i);break;default:j=new THREE.Mesh(h,i)}delete g[c].type;for(var d in g[c])"undefined"!=typeof j[d]?j[d]=g[c][d]:j.userData[d]=g[c][d],delete g[c];g[c]=j}}function h(){var c=document.createElement("div"),d=document.createElement("div");c.style.cssText="background: "+b.background+";position: relative;overflow: hidden;";var e=b.size.indexOf("%")>-1?parseInt(b.size)/2+"%":parseInt(b.size)/2+"px";console.log(e),d.style.cssText="width: "+b.size+"; height: "+b.size+";top: 50%; left: 50%;margin: -"+e+" 0 0 -"+e+";position: relative;",o.domElement=c,o.infoContainer=d,o.resize(a.domElement.width,a.domElement.height),a.domElement.parentNode.appendChild(c)}function i(){switch(b.type){case"bar":j();break;case"circle":k();break;default:j()}}function j(){var a=document.createElement("div"),c=document.createElement("div");a.style.cssText="background: "+b.progressBarContainer+";border: solid 1px "+b.progressBarContainer+";width: "+b.size+"; height: 6px;top: 50%; left: 50%;box-sizing: border-box;margin-left: -50%;position: relative;",c.style.cssText="background: "+b.progressBar+";width: 0%; height: 100%;top: 0; left: 0;position: absolute;",a.appendChild(c),o.infoContainer.appendChild(a);var d=function(){c.style.width=(100*v.progress).toString()+"%"};w.push(function(){TweenLite.to(v,u,{progress:s,onUpdate:d})})}function k(){}function l(a){var b=0,c=0;for(var d in F)b+=F[d].prog*F[d].fileSize;for(var d in G)c+=G[d].prog*G[d].fileSize;if(s=(b+c)/(H+I),"undefined"!=typeof a&&q){var e=a.texture?"Texture":a.geometry?"Geometry":"Unknown asset type";console.info("Progress = "+s+", "+e+" > "+a.name+" > "+Math.round(100*a.progress)+"%")}m()}function m(a){for(var c=0;c<w.length;c++)w[c](s);if(1===s&&a){var d=function(){o.resources&&g(),n()};"custom"!==b.type?setTimeout(d,1e3*u):d()}}function n(){for(var a=0;a<x.length;a++)x[a]()}var o=this,p=null,q=!1,r=!1,s=0,t=!1,u=.5,v={progress:0},w=[],x=[],y,z=0,A=0,B=0,C={},D,E={},F={},G={},H=0,I=0;return this.domElement=null,this.infoContainer=null,this.resources=null,this.resize=c,b=b||{},b={type:"undefined"!=typeof b.type?b.type:"bar",size:b.size?b.size:"100px",background:b.background?b.background:"#ddd",progressBarContainer:b.progressBarContainer?b.progressBarContainer:"#bbb",progressBar:b.progressBar?b.progressBar:"#666",percentInfo:"undefined"!=typeof b.percentInfo&&b.percentInfo,sizeInfo:"undefined"!=typeof b.sizeInfo&&b.sizeInfo,textInfo:"undefined"!=typeof b.textInfo?b.textInfo:["Loading","Processing"]},h(),"custom"!==b.type&&i(),this.start=function(a){return b!==!1&&o.domElement.appendChild(o.infoContainer),a&&(o.resources=a,d()),o},this.remove=function(){o.domElement.parentNode.removeChild(o.domElement),t=!0},this.setProgress=function(a){s=a,m(!0)},this.setOptions=function(a){return u="undefined"!=typeof a.tweenDuration?a.tweenDuration:u,r="undefined"!=typeof a.forcedStart?a.forcedStart:r,q="undefined"!=typeof a.verbose?a.verbose:q,o},this.onProgress=function(){for(var a=0;a<arguments.length;a++)arguments[a]&&"function"==typeof arguments[a]&&w.push(arguments[a]);return o},this.onComplete=function(){for(var a=0;a<arguments.length;a++)arguments[a]&&"function"==typeof arguments[a]&&x.push(arguments[a]);return o},this}